<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>title</title>
    <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
  </head>
  <body>
    <h2>Firebase Example</h2>
    <input type='text' id='messageInput'  placeholder='Type a message...'>
    <h2>Results</h2>
    <input type='text' id='results'>
    <button type="button" onclick="savedata()">Click Me!</button>
    <script>
    var messagesRef = new Firebase('https://brilliant-fire-3159.firebaseio.com/users');
    var isNewUser = true;

    // For user authentication
    function authHandler(error, authData) {
      if (error) {
        console.log("Login Failed!", error);
      } else {
        console.log("Authenticated successfully with payload:", authData);
      }
    }

     function getName(authData) {
      switch(authData.provider) {
         case 'password':
           console.log(authData.password.email.replace(/@.*/, ''));
           return authData.password.email.replace(/@.*/, '');
         case 'twitter':
           console.log(authData.twitter.displayName);
           return authData.twitter.displayName;
         case 'facebook':
           console.log(authData.facebook.displayName);
           return authData.facebook.displayName;
      }
    }

    // Or with an email/password combination
    messagesRef.authWithPassword({
      email    : 'bobtony@firebdddase.com',
      password : 'correcthorsebatterystaple'
    }, authHandler);

    messagesRef.onAuth(function(authData) {
    if (authData && isNewUser) {
      console.log('authData');
      // save the user's profile into the database so we can list users,
      // use them in Security and Firebase Rules, and show profiles
      messagesRef.child("users").child(authData.uid).set({
        provider: authData.provider,
        name: getName(authData)
      });
    }
  });



    //var messageField = $('#');
    var messageField = document.getElementById('messageInput');
    var messageResults = document.getElementById('results');

    function savedata(){
      var message = messageField.value;

      // SAVE DATA TO FIREBASE AND EMPTY FIELD
      console.log(message);
      messagesRef.push({fieldName:'messageField', text:message});
      messageField.value = '';
    }


    // Read the data out
    messagesRef.limitToLast(10).on('child_added', function (snapshot) {
      //GET DATA
      console.time('Timestart');
      var data = snapshot.val();
      var message = data.text;
      console.timeEnd('Timestart');
      console.log(message);

      //CREATE ELEMENTS MESSAGE & SANITIZE TEXT
      messageResults.value += " " + message;

    });
    </script>
  </body>
</html>
